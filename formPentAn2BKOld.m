function B=formPentAn2BKOld(c1,c2,c3,c5,k12,k21,Cn,Cp,nL,psiS,psiC)

	bn2=cat(1,zeros(2,1),...
        c5(3:end-1).*((1-c1(1:end-3))./(c2(1:end-3).*k21(1:end-2).*Cn(1:end-2))),...
        c3(end)*((1-c1(end-2))./(c2(end-2)*k21(end-1)*Cn(end-1))))...
        .*cat(1,zeros(2,1),psiS(1:end-2));

    bn1=cat(1,0,...
        c5(2)*(2*c5(1)-1)/c5(1),...
        c5(3:end-1).*(2-1./c5(2:end-2)+(1-c1(2:end-2))./(c2(2:end-2).*Cn(1:end-2))),...
        c3(end)*(2-1./c5(end-1)+(1-c1(end-1))./(c2(end-1).*Cn(end-1))))...
        .*cat(1,0,psiS(1:end-1));
    b0=cat(1,1-2*c5(1:end-1),1-c3(end)).*psiS;
    b01=cat(1,c5(1:end-2).*(2-1./c5(2:end-1)+(1-c1(2:end-1))./(c2(2:end-1).*Cp(2:end))),...
        c5(end-1)*((c3(end)-1)/c3(end)),0)...
        .*cat(1,psiS(2:end),0);
    b02=cat(1,c5(1:end-2).*(1-c1(3:end))./(c2(3:end).*k12(2:end).*Cp(2:end)),...
        zeros(2,1))...
        .*cat(1,psiS(3:end),zeros(2,1));
    
    bc=cat(1,c5(1),-c5(2),zeros(nL-2,1))*psiC;

    B=bc+bn2+bn1+b0+b01+b02;
    
end
