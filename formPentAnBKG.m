function B=formPentAnBKG(b2,c1,b12,b21,c12,c21,k12,k21,Cn,Cp,nL,psiS,GC)

	bn2=cat(1,zeros(2,1),...
        k12(2:end).*c21(1:end-1).*(1-c1(1:end-2))./(b2(3:end).*Cn(1:end-1)))...
        .*cat(1,zeros(2,1),psiS(1:end-2));
    bn1=cat(1,0,...
        k12(1)*b12(1),...
        k12(2:end).*(b12(2:end)-(1-c1(2:end-1))./(b2(3:end).*Cn(1:end-1))))...
        .*cat(1,0,psiS(1:end-1));
    b0=ones(nL,1).*psiS;
    b01=cat(1,k21(1:end-1).*(b21(1:end-1)-(1-c1(2:end-1))./(b2(1:end-2).*Cp(2:end))),...
        k21(end)*b21(end),0)...
        .*cat(1,psiS(2:end),0);
    b02=cat(1,k21(1)*c12(2)/b2(1)*(1-c1(3))/Cp(2),...
        k21(2:end-1).*c12(3:end).*(1-c1(4:end))./(b2(2:end-2).*Cp(3:end)),...
        zeros(2,1))...
        .*cat(1,psiS(3:end),zeros(2,1));
    bc=cat(1,1/b2(1),k12(1)/b2(2),zeros(nL-2,1))*GC;

    B=bc+bn2+bn1+b0+b01+b02;
    
end